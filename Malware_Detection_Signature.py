#!/usr/bin/env python3

# Script Name: Signature-based Malware Detection Part 2 of 3
# Author: Festus Oguhebe Jr. 
# Purpose: Detection and remediation of malware is the core function of many security products, and an optional secondary feature on others like perimeter firewalls and proxy servers.


import os
import hashlib
from datetime import datetime

def generate_md5_hash(file_path):
    hash_md5 = hashlib.md5()
    with open(file_path, "rb") as f:
        for chunk in iter(lambda: f.read(4096), b""):
            hash_md5.update(chunk)
    return hash_md5.hexdigest()

def scan_directory(directory_path):
    for root, dirs, files in os.walk(directory_path):
        for name in files:
            file_path = os.path.join(root, name)
            file_size = os.path.getsize(file_path)
            md5_hash = generate_md5_hash(file_path)
            timestamp = datetime.now().strftime("%Y-%m-%d %H:%M:%S")
            print(f"Timestamp: {timestamp}, File Name: {name}, File Size: {file_size} bytes, MD5 Hash: {md5_hash}, Path: {file_path}")

# Example directory path (user should replace this with their input)
directory_path = "/path/to/directory"
scan_directory(directory_path)
